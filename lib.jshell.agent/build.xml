<?xml version="1.0" encoding="UTF-8"?>
<!-- You may freely edit this file. See harness/README in the NetBeans platform -->
<!-- for some information on what you could do (e.g. targets to override). -->
<!-- If you delete this file and reopen the project it will be recreated. -->
<project name="lib.jshell.agent" default="netbeans" basedir=".">
    <description>Builds, tests, and runs the project org.netbeans.lib.jshell.agent.</description>
    <import file="../nbbuild/templates/projectized.xml"/>


   <target name="probe" depends="init">
        <mkdir dir="build/agent/classes"/>
        <unjar src="${agentsrc.asm.cp}" dest="build/agent/classes">
            <patternset>
                <exclude name="META-INF/**"/>
            </patternset>
        </unjar>
        <javac srcdir="agentsrc" destdir="build/agent/classes" debug="true" deprecation="true" target="1.7" source="1.7">
	    <classpath>
		<pathelement path="${agentsrc.asm.cp}"/>
	    </classpath>
	</javac>
        <mkdir dir="${cluster}/modules/ext"/>
        <jar jarfile="${cluster}/modules/ext/nb-custom-jshell-probe.jar">
            <manifest>
                <attribute name="NetBeans-Own-Library" value="true"/>
                <attribute name="Main-Class" value="jdk.internal.jshell.remote.AgentWorker"/>
                <attribute name="Premain-Class" value="org.netbeans.lib.jshell.agent.NbJShellAgent"/>
                <attribute name="Can-Redefine-Classes" value="true"/>
                <attribute name="Can-Retransform-Classes" value="true"/>
            </manifest>
            <fileset dir="build/agent/classes"/>
        </jar>
    </target>

    <target name="netbeans-extra" depends="probe"/></project>
