<?xml version="1.0" encoding="UTF-8"?>
<project basedir="." default="netbeans" name="dlight.kit">
    <description>Builds, tests, and runs the project dlight.kit</description>
    <import file="../nbbuild/templates/projectized.xml"/>

    <macrodef name="dlight-coverage-report" description="Call module's coverage-report target with report format set to xml">
        <attribute name="module"/>
        <sequential>
            <subant target="coverage-report" buildpath="../@{module}" failonerror="false">
                <property name="coverage.report.format" value="xml"/>
            </subant>
        </sequential>
    </macrodef>

    <target name="coverage-report-all" description="Run all tests in the dlight cluster and create coverage report">
        <dlight-coverage-report module="dlight.core.stack"/>
        <dlight-coverage-report module="dlight.db.derby"/>
        <dlight-coverage-report module="dlight.db.h2"/>
        <dlight-coverage-report module="dlight.dtrace"/>
        <dlight-coverage-report module="dlight.extras"/>
        <dlight-coverage-report module="dlight.indicators"/>
        <!--<dlight-coverage-report module="dlight.nativeexecution"/>-->
        <dlight-coverage-report module="dlight.perfan"/>
        <dlight-coverage-report module="dlight.tools"/>
        <dlight-coverage-report module="dlight.util"/>
        <dlight-coverage-report module="dlight"/>
    </target>


    <macrodef name="dlight-test" description="Call module's test target">
        <attribute name="module"/>
        <sequential>
            <subant target="test" buildpath="../@{module}" failonerror="false"/>
        </sequential>
    </macrodef>

    <target name="test-all" description="Run all tests in the dlight cluster">
        <dlight-test module="dlight.core.stack"/>
        <dlight-test module="dlight.db.derby"/>
        <dlight-test module="dlight.db.h2"/>
        <dlight-test module="dlight.dtrace"/>
        <dlight-test module="dlight.extras"/>
        <dlight-test module="dlight.indicators"/>
        <!--<dlight-test module="dlight.nativeexecution"/>-->
        <dlight-test module="dlight.perfan"/>
        <dlight-test module="dlight.tools"/>
        <dlight-test module="dlight.util"/>
        <dlight-test module="dlight"/>
    </target>

</project>
